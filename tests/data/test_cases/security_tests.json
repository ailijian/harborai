{
  "authentication_tests": {
    "description": "èº«ä»½è®¤è¯å®‰å…¨æµ‹è¯•ç”¨ä¾‹",
    "test_cases": [
      {
        "test_id": "SEC_AUTH_001",
        "name": "APIå¯†é’¥éªŒè¯æµ‹è¯•",
        "description": "æµ‹è¯•å„ç§APIå¯†é’¥éªŒè¯åœºæ™¯",
        "test_scenarios": [
          {
            "scenario": "æœ‰æ•ˆAPIå¯†é’¥",
            "api_key": "valid_key_format",
            "expected_result": {
              "status": "success",
              "access_granted": true
            }
          },
          {
            "scenario": "æ— æ•ˆAPIå¯†é’¥æ ¼å¼",
            "api_key": "invalid_format",
            "expected_result": {
              "status": "error",
              "error_code": "INVALID_API_KEY",
              "access_granted": false
            }
          },
          {
            "scenario": "ç©ºAPIå¯†é’¥",
            "api_key": "",
            "expected_result": {
              "status": "error",
              "error_code": "MISSING_API_KEY",
              "access_granted": false
            }
          },
          {
            "scenario": "è¿‡æœŸAPIå¯†é’¥",
            "api_key": "expired_key",
            "expected_result": {
              "status": "error",
              "error_code": "EXPIRED_API_KEY",
              "access_granted": false
            }
          },
          {
            "scenario": "è¢«æ’¤é”€çš„APIå¯†é’¥",
            "api_key": "revoked_key",
            "expected_result": {
              "status": "error",
              "error_code": "REVOKED_API_KEY",
              "access_granted": false
            }
          }
        ]
      },
      {
        "test_id": "SEC_AUTH_002",
        "name": "å¤šå‚å•†è®¤è¯ä¸€è‡´æ€§æµ‹è¯•",
        "description": "æµ‹è¯•ä¸åŒå‚å•†APIçš„è®¤è¯æœºåˆ¶ä¸€è‡´æ€§",
        "vendors": [
          {
            "vendor": "deepseek",
            "auth_method": "bearer_token",
            "header_format": "Authorization: Bearer {api_key}",
            "error_responses": {
              "invalid_key": {
                "status_code": 401,
                "error_message": "Invalid API key"
              },
              "missing_key": {
                "status_code": 401,
                "error_message": "Missing API key"
              }
            }
          },
          {
            "vendor": "ernie",
            "auth_method": "api_key_header",
            "header_format": "X-API-Key: {api_key}",
            "error_responses": {
              "invalid_key": {
                "status_code": 403,
                "error_message": "Forbidden: Invalid API key"
              },
              "missing_key": {
                "status_code": 401,
                "error_message": "Unauthorized: Missing API key"
              }
            }
          },
          {
            "vendor": "doubao",
            "auth_method": "bearer_token",
            "header_format": "Authorization: Bearer {api_key}",
            "error_responses": {
              "invalid_key": {
                "status_code": 401,
                "error_message": "Authentication failed"
              },
              "missing_key": {
                "status_code": 401,
                "error_message": "Authentication required"
              }
            }
          }
        ]
      }
    ]
  },
  "input_validation_tests": {
    "description": "è¾“å…¥éªŒè¯å®‰å…¨æµ‹è¯•ç”¨ä¾‹",
    "test_cases": [
      {
        "test_id": "SEC_INPUT_001",
        "name": "æ¶æ„è¾“å…¥æ£€æµ‹æµ‹è¯•",
        "description": "æµ‹è¯•å¯¹å„ç§æ¶æ„è¾“å…¥çš„æ£€æµ‹å’Œå¤„ç†",
        "malicious_inputs": [
          {
            "input_type": "sql_injection",
            "content": "'; DROP TABLE users; --",
            "expected_behavior": {
              "blocked": true,
              "sanitized": true,
              "logged": true
            }
          },
          {
            "input_type": "xss_script",
            "content": "<script>alert('XSS')</script>",
            "expected_behavior": {
              "blocked": true,
              "sanitized": true,
              "logged": true
            }
          },
          {
            "input_type": "command_injection",
            "content": "; rm -rf / --no-preserve-root",
            "expected_behavior": {
              "blocked": true,
              "sanitized": true,
              "logged": true
            }
          },
          {
            "input_type": "path_traversal",
            "content": "../../../etc/passwd",
            "expected_behavior": {
              "blocked": true,
              "sanitized": true,
              "logged": true
            }
          }
        ]
      },
      {
        "test_id": "SEC_INPUT_002",
        "name": "è¾“å…¥é•¿åº¦é™åˆ¶æµ‹è¯•",
        "description": "æµ‹è¯•è¶…é•¿è¾“å…¥çš„å¤„ç†æœºåˆ¶",
        "test_scenarios": [
          {
            "input_size": "normal",
            "content_length": 1000,
            "expected_result": "æ­£å¸¸å¤„ç†"
          },
          {
            "input_size": "large",
            "content_length": 10000,
            "expected_result": "æ­£å¸¸å¤„ç†æˆ–é€‚å½“æˆªæ–­"
          },
          {
            "input_size": "oversized",
            "content_length": 100000,
            "expected_result": {
              "status": "error",
              "error_code": "INPUT_TOO_LARGE",
              "max_allowed_length": 32768
            }
          },
          {
            "input_size": "extreme",
            "content_length": 1000000,
            "expected_result": {
              "status": "error",
              "error_code": "REQUEST_ENTITY_TOO_LARGE",
              "connection_terminated": true
            }
          }
        ]
      },
      {
        "test_id": "SEC_INPUT_003",
        "name": "ç‰¹æ®Šå­—ç¬¦å¤„ç†æµ‹è¯•",
        "description": "æµ‹è¯•å„ç§ç‰¹æ®Šå­—ç¬¦å’Œç¼–ç çš„å¤„ç†",
        "special_characters": [
          {
            "type": "unicode_control",
            "content": "\u0000\u0001\u0002\u0003",
            "expected_behavior": "è¿‡æ»¤æˆ–è½¬ä¹‰æ§åˆ¶å­—ç¬¦"
          },
          {
            "type": "emoji_and_symbols",
            "content": "ğŸš€ğŸ’»ğŸ”’ğŸ›¡ï¸",
            "expected_behavior": "æ­£å¸¸å¤„ç†Unicodeè¡¨æƒ…ç¬¦å·"
          },
          {
            "type": "mixed_encoding",
            "content": "Helloä¸–ç•ŒğŸŒ",
            "expected_behavior": "æ­£ç¡®å¤„ç†æ··åˆç¼–ç æ–‡æœ¬"
          },
          {
            "type": "zero_width_chars",
            "content": "text\u200B\u200C\u200Dhere",
            "expected_behavior": "æ£€æµ‹å¹¶å¤„ç†é›¶å®½å­—ç¬¦"
          }
        ]
      }
    ]
  },
  "rate_limiting_tests": {
    "description": "é€Ÿç‡é™åˆ¶å®‰å…¨æµ‹è¯•ç”¨ä¾‹",
    "test_cases": [
      {
        "test_id": "SEC_RATE_001",
        "name": "APIè°ƒç”¨é¢‘ç‡é™åˆ¶æµ‹è¯•",
        "description": "æµ‹è¯•APIè°ƒç”¨é¢‘ç‡é™åˆ¶æœºåˆ¶",
        "rate_limit_scenarios": [
          {
            "scenario": "æ­£å¸¸é¢‘ç‡",
            "requests_per_minute": 60,
            "expected_result": "æ‰€æœ‰è¯·æ±‚æˆåŠŸ"
          },
          {
            "scenario": "æ¥è¿‘é™åˆ¶",
            "requests_per_minute": 95,
            "expected_result": "å¤§éƒ¨åˆ†è¯·æ±‚æˆåŠŸï¼Œå¯èƒ½æœ‰è­¦å‘Š"
          },
          {
            "scenario": "è¶…å‡ºé™åˆ¶",
            "requests_per_minute": 120,
            "expected_result": {
              "status": "error",
              "error_code": "RATE_LIMIT_EXCEEDED",
              "retry_after": 60
            }
          },
          {
            "scenario": "çªå‘è¯·æ±‚",
            "burst_requests": 50,
            "time_window_seconds": 10,
            "expected_result": {
              "initial_requests_success": true,
              "subsequent_requests_blocked": true,
              "rate_limit_headers_present": true
            }
          }
        ]
      },
      {
        "test_id": "SEC_RATE_002",
        "name": "åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡é˜²æŠ¤æµ‹è¯•",
        "description": "æµ‹è¯•DDoSæ”»å‡»é˜²æŠ¤æœºåˆ¶",
        "attack_scenarios": [
          {
            "attack_type": "high_frequency_requests",
            "concurrent_connections": 1000,
            "requests_per_connection": 100,
            "expected_protection": {
              "connection_throttling": true,
              "request_queuing": true,
              "automatic_blocking": true
            }
          },
          {
            "attack_type": "slow_loris",
            "slow_connections": 500,
            "connection_timeout": 30,
            "expected_protection": {
              "connection_timeout_enforcement": true,
              "resource_cleanup": true,
              "service_availability": true
            }
          }
        ]
      }
    ]
  },
  "data_privacy_tests": {
    "description": "æ•°æ®éšç§å®‰å…¨æµ‹è¯•ç”¨ä¾‹",
    "test_cases": [
      {
        "test_id": "SEC_PRIV_001",
        "name": "æ•æ„Ÿä¿¡æ¯æ£€æµ‹æµ‹è¯•",
        "description": "æµ‹è¯•å¯¹æ•æ„Ÿä¿¡æ¯çš„æ£€æµ‹å’Œå¤„ç†",
        "sensitive_data_types": [
          {
            "data_type": "credit_card",
            "test_input": "æˆ‘çš„ä¿¡ç”¨å¡å·æ˜¯ 4532-1234-5678-9012",
            "expected_behavior": {
              "detected": true,
              "masked": true,
              "logged_securely": true,
              "user_warned": true
            }
          },
          {
            "data_type": "social_security",
            "test_input": "æˆ‘çš„èº«ä»½è¯å·æ˜¯ 123456789012345678",
            "expected_behavior": {
              "detected": true,
              "masked": true,
              "logged_securely": true,
              "user_warned": true
            }
          },
          {
            "data_type": "email_address",
            "test_input": "æˆ‘çš„é‚®ç®±æ˜¯ user@example.com",
            "expected_behavior": {
              "detected": true,
              "handling_policy_applied": true
            }
          },
          {
            "data_type": "phone_number",
            "test_input": "æˆ‘çš„ç”µè¯æ˜¯ +86-138-0013-8000",
            "expected_behavior": {
              "detected": true,
              "handling_policy_applied": true
            }
          }
        ]
      },
      {
        "test_id": "SEC_PRIV_002",
        "name": "æ•°æ®ä¼ è¾“åŠ å¯†æµ‹è¯•",
        "description": "æµ‹è¯•æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­çš„åŠ å¯†ä¿æŠ¤",
        "encryption_tests": [
          {
            "protocol": "HTTPS",
            "tls_version": "1.3",
            "cipher_suite": "TLS_AES_256_GCM_SHA384",
            "expected_result": "æ•°æ®ä¼ è¾“å®Œå…¨åŠ å¯†"
          },
          {
            "protocol": "HTTP",
            "expected_result": {
              "status": "blocked",
              "redirect_to_https": true,
              "security_warning": true
            }
          }
        ]
      }
    ]
  },
  "access_control_tests": {
    "description": "è®¿é—®æ§åˆ¶å®‰å…¨æµ‹è¯•ç”¨ä¾‹",
    "test_cases": [
      {
        "test_id": "SEC_ACCESS_001",
        "name": "æƒé™è¾¹ç•Œæµ‹è¯•",
        "description": "æµ‹è¯•ä¸åŒæƒé™çº§åˆ«çš„è®¿é—®æ§åˆ¶",
        "permission_levels": [
          {
            "level": "basic",
            "allowed_operations": ["chat", "simple_completion"],
            "denied_operations": ["reasoning", "fine_tuning", "admin_functions"]
          },
          {
            "level": "premium",
            "allowed_operations": ["chat", "simple_completion", "reasoning", "advanced_features"],
            "denied_operations": ["fine_tuning", "admin_functions"]
          },
          {
            "level": "enterprise",
            "allowed_operations": ["chat", "simple_completion", "reasoning", "advanced_features", "fine_tuning"],
            "denied_operations": ["admin_functions"]
          },
          {
            "level": "admin",
            "allowed_operations": ["all_operations"],
            "denied_operations": []
          }
        ]
      },
      {
        "test_id": "SEC_ACCESS_002",
        "name": "ä¼šè¯ç®¡ç†æµ‹è¯•",
        "description": "æµ‹è¯•ä¼šè¯çš„åˆ›å»ºã€ç»´æŠ¤å’Œé”€æ¯",
        "session_tests": [
          {
            "test_type": "session_creation",
            "expected_behavior": {
              "unique_session_id": true,
              "secure_token_generation": true,
              "session_timeout_set": true
            }
          },
          {
            "test_type": "session_hijacking_prevention",
            "attack_scenarios": [
              "session_id_prediction",
              "session_fixation",
              "cross_site_request_forgery"
            ],
            "expected_protection": true
          },
          {
            "test_type": "session_cleanup",
            "cleanup_triggers": [
              "explicit_logout",
              "session_timeout",
              "security_violation"
            ],
            "expected_behavior": {
              "session_invalidated": true,
              "resources_cleaned": true,
              "audit_logged": true
            }
          }
        ]
      }
    ]
  }
}